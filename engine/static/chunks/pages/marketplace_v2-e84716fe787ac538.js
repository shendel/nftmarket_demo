(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[203],{76771:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/marketplace_v2",function(){return t(92762)}])},14284:function(e,n,t){"use strict";var a=t(47568),s=t(29815),o=t(34051),r=t.n(o),i=t(64914),c=t.n(i),l=t(53419);n.Z=function(e){return new Promise((function(n,t){var o=e.activeWeb3,i=(e.chainId,e.tokenAddress),d=e.approveFor,u=e.weiAmount,f=e.onTrx||function(){},p=e.onSuccess||function(){},m=e.onError||function(){},g=e.onFinally||function(){};o.eth.getAccounts().then(function(){var e=(0,a.Z)(r().mark((function e(a){var y,x,h,v;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(a.length>0)){e.next=10;break}return x=a[0],h=new o.eth.Contract(c(),i),e.next=6,(0,l.A)(x,h,"approve",[d,u]);case 6:v=e.sent,(y=h.methods).approve.apply(y,(0,s.Z)([d,u])).send(v).on("transactionHash",(function(e){console.log("transaction hash:",e),f(e)})).on("error",(function(e){console.log("transaction error:",e),m(e),t(e)})).on("receipt",(function(e){console.log("transaction receipt:",e),p(e)})).then((function(e){n(e),g(e)})),e.next=11;break;case 10:t("NO_ACTIVE_ACCOUNT");case 11:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()).catch((function(e){console.log(">>> approveToken",e),t(e)}))}))}},23689:function(e,n,t){"use strict";var a=t(3283),s=t.n(a),o=t(99312),r=t(64262),i=t(81586),c=t(26566),l=t(42304);n.Z=function(e){var n=e.address,t=e.chainId,a=e.ids;return new Promise((function(e,d){var u=(0,r.T_)(t);if(u&&u.rpcUrls)try{var f=new(new(s())(u.rpcUrls[0]).eth.Contract)(o,r.Ce[t]),p=new i.vU(c),m={baseExtension:{func:"baseExtension"}};a.forEach((function(e){m[e]={func:"tokenURI",args:[e]}})),(0,l.O)({multicall:f,target:n,encoder:p,calls:m}).then((function(n){var t={};Object.keys(n).forEach((function(e){"baseExtension"!==e&&(n.baseExtension?t[e]="".concat(n[e]).concat(e).concat(n.baseExtension):t[e]=n[e])})),console.log(">>> fetchNftContent",t),e(t)})).catch((function(e){console.log(">>> Fail fetch all info",e),d(e)}))}catch(g){console.log(">>> err",g),d(g)}else d("NOT_SUPPORTED_CHAIN")}))}},76870:function(e,n,t){"use strict";var a=t(47568),s=t(26042),o=t(29815),r=t(34051),i=t.n(r),c=t(26566),l=t(64262),d=t(42304),u=t(99312),f=t(81586),p=t(3283),m=t.n(p);n.Z=function(e){return new Promise(function(){var n=(0,a.Z)(i().mark((function n(t,a){var r,p,g,y,x,h,v,b,j,k,T,N,w,S,A,C;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=(0,s.Z)({onlyIds:!1},e),p=r.chainId,g=r.walletAddress,y=r.nftAddress,x=r.onlyIds,!(h=(0,l.T_)(p))){n.next=39;break}return v=new(m())(h.rpcUrls[0]),b=new v.eth.Contract(c,y),j=!1,k=!1,T=0,N=0,n.prev=9,n.next=12,b.methods.totalSupply().call();case 12:T=n.sent,j=!0,n.next=18;break;case 16:n.prev=16,n.t0=n.catch(9);case 18:return n.prev=18,n.next=21,b.methods.maxSupply().call();case 21:N=n.sent,k=!0,n.next=36;break;case 25:return n.prev=25,n.t1=n.catch(18),n.prev=27,n.next=30,b.methods.MAX_SUPPLY().call();case 30:N=n.sent,k=!0,n.next=36;break;case 34:n.prev=34,n.t2=n.catch(27);case 36:if(k||j){for(w=new v.eth.Contract(u,l.Ce[p]),S=new f.vU(c),A=[],C=0;C<=(N||T);C++)A=(0,o.Z)(A).concat([{group:C,func:"ownerOf",args:[C],encoder:S,target:y}],(0,o.Z)(x?[]:[{group:C,func:"tokenURI",args:[C],encoder:S,target:y}]));(0,d.L)({multicall:w,calls:A}).then((function(e){var n=Object.keys(e).map((function(n){return(0,s.Z)({tokenId:n},e[n])})).filter((function(e){return e&&e.ownerOf&&e.ownerOf.toLowerCase()==g.toLowerCase()}));t(n)})).catch((function(e){console.log(">> err",e),a(e)}))}else a("NOT SUPPORTED");n.next=40;break;case 39:a("UNKNOWN CHAIN");case 40:case"end":return n.stop()}}),n,null,[[9,16],[18,25],[27,34]])})));return function(e,t){return n.apply(this,arguments)}}())}},12975:function(e,n,t){"use strict";t.d(n,{W:function(){return a}});var a=function(e){return e.startsWith("ipfs://")?"".concat("https://ipfs.io/ipfs/").concat(e.substring(7)):e}},27533:function(e,n,t){"use strict";t.d(n,{a:function(){return d},r:function(){return l}});var a=t(47568),s=t(26042),o=t(34051),r=t.n(o),i=t(26566),c=t(53419),l=function(e){var n=e.activeWeb3,t=e.nftAddress,s=e.operatorAddress;return console.log(">>> options",e),new Promise((function(e,o){n.eth.getAccounts().then(function(){var c=(0,a.Z)(r().mark((function a(c){var l;return r().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:c.length>0?(l=c[0],new n.eth.Contract(i,t).methods.isApprovedForAll(l,s).call().then((function(n){e(n)})).catch((function(e){o(e)}))):o("NO_ACTIVE_ACCOUNT");case 1:case"end":return a.stop()}}),a)})));return function(e){return c.apply(this,arguments)}}()).catch((function(e){console.log(">>> NftIsApproved",e),o(e)}))}))},d=function(e){var n=(0,s.Z)({onTrx:function(){},onSuccess:function(){},onError:function(){},onFinally:function(){},isAllow:!0},e),t=n.activeWeb3,o=n.nftAddress,l=n.operatorAddress,d=n.onTrx,u=n.onSuccess,f=n.onError,p=n.onFinally,m=n.isAllow;return new Promise((function(e,n){t.eth.getAccounts().then(function(){var s=(0,a.Z)(r().mark((function a(s){var g,y,x,h;return r().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(!(s.length>0)){a.next=13;break}return g=s[0],y=new t.eth.Contract(i,o),a.next=5,(0,c.A)(g,y,"setApprovalForAll",[l,m],0);case 5:return x=a.sent,a.next=8,t.eth.getGasPrice();case 8:h=a.sent,x.gasPrice=h,y.methods.setApprovalForAll(l,m).send(x).on("transactionHash",(function(e){console.log("transaction hash:",e),d(e)})).on("error",(function(e){console.log("transaction error:",e),f(e),n(e)})).on("receipt",(function(e){console.log("transaction receipt:",e),u(e)})).then((function(n){e(n),p(n)})),a.next=14;break;case 13:n("NO_ACTIVE_ACCOUNT");case 14:case"end":return a.stop()}}),a)})));return function(e){return s.apply(this,arguments)}}()).catch((function(e){console.log(">>> NftSetApprove",e),n(e)}))}))}},92762:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return z}});var a=t(47568),s=t(26042),o=t(69396),r=t(34051),i=t.n(r),c=t(85893),l=t(66089),d=t.n(l),u=t(67294),f=t(214),p=t.n(f),m=t(78967),g=t(15200),y=t(11163),x=t(64708),h=function(e){(0,y.useRouter)();var n=e.getDesign,t=e.getText;return(0,c.jsx)(c.Fragment,{children:(0,c.jsx)("div",{className:"".concat(p().mainLogo," logoAddParams"),children:(0,c.jsx)("a",{href:(0,x.Rg)("index"),children:(0,c.jsx)("img",{src:n("logoUri","uri",(0,x.Vh)("images/logo.png","mainLogo")),alt:t("Stake NFT - earn ERC20","MainPage_Header")})})})})},v=t(13533),b=t(36860),j=t(44423),k=t(83300),T=t.n(k),N=t(12975),w=t(71931);function S(e){var n=e.url,t=(0,u.useState)(!1),a=t[0],s=t[1],o=(0,u.useState)(!0),r=o[0],i=o[1],l=(0,u.useState)(!1),f=l[0],p=l[1],m=(0,u.useState)(!1),g=(m[0],m[1]),y=(0,u.useState)({}),x=y[0],h=y[1];(0,u.useState)((function(){n&&T()((0,N.W)(n)).then((function(e){return e.headers.get("content-type").startsWith("image/")?"IMAGE":e.text()})).then((function(e){if("IMAGE"==e)return"IMAGE";try{return JSON.parse(e.slice(1))}catch(n){try{return JSON.parse(e)}catch(t){return"FAIL_PARSE"}}})).then((function(e){s(!0),i(!1),"FAIL_PARSE"!==e&&"IMAGE"!==e?h(e):"IMAGE"===e?p(!0):g(!0)})).catch((function(e){console.log("fail fetch",e)}))}),[n]);var v=(0,u.useState)(!1),b=v[0],j=v[1],k=function(){j(!0)};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(d(),{id:"c58d8a1c09f83ddb",dynamic:[(0,w.V)("images/nft-media-loading.svg")],children:".nftMedia.__jsx-style-dynamic-selector IMG.__jsx-style-dynamic-selector{opacity:0;-webkit-transition:opacity.3s linear;-moz-transition:opacity.3s linear;-o-transition:opacity.3s linear;transition:opacity.3s linear}.nftMedia.isLoaded.__jsx-style-dynamic-selector IMG.__jsx-style-dynamic-selector{opacity:1}.nftMedia.__jsx-style-dynamic-selector{background:url(".concat((0,w.V)("images/nft-media-loading.svg"),");background-position:center;-webkit-background-size:contain;-moz-background-size:contain;-o-background-size:contain;background-size:contain;background-repeat:no-repeat}.nftMedia.isLoaded.__jsx-style-dynamic-selector{background:none}")}),(0,c.jsx)("div",{className:d().dynamic([["c58d8a1c09f83ddb",[(0,w.V)("images/nft-media-loading.svg")]]])+" "+"nftMedia ".concat(b?"isLoaded":""),children:r?(0,c.jsx)("div",{className:d().dynamic([["c58d8a1c09f83ddb",[(0,w.V)("images/nft-media-loading.svg")]]]),children:"Fetching"}):(0,c.jsx)(c.Fragment,{children:a&&(0,c.jsxs)(c.Fragment,{children:[x&&x.image&&(0,c.jsx)(c.Fragment,{children:(0,c.jsx)("img",{src:(0,N.W)(x.image),onLoad:k,loading:"lazy",className:d().dynamic([["c58d8a1c09f83ddb",[(0,w.V)("images/nft-media-loading.svg")]]])})}),f&&(0,c.jsx)("img",{src:(0,N.W)(n),onLoad:k,loading:"lazy",className:d().dynamic([["c58d8a1c09f83ddb",[(0,w.V)("images/nft-media-loading.svg")]]])}),x&&x.name&&(0,c.jsx)("strong",{className:d().dynamic([["c58d8a1c09f83ddb",[(0,w.V)("images/nft-media-loading.svg")]]]),children:x.name})]})})})]})}var A=function(e){var n=e.tokenId,t=e.currentUser,a=e.tokenUri,s=e.price,o=e.seller,r=e.currency,i=e.needApprove,l=e.isApproving,d=e.isBuying,u=e.onBuy,f=e.isActive,m=e.onApproveAndBuy,g=(e.openConfirmWindow,e.isUserNFT),y=e.isTradeAllow,x=e.isRemoveFromTrade,h=e.onRemoveFromTrade,v=e.onAddToTrade,b=e.isPreview,k=e.isWalletConnected,T=e.isBaseConfigReady,N=o&&o.toUpperCase()===t.toUpperCase();return(0,c.jsxs)("div",{className:"".concat(p().nftBox," nftTokenBox ").concat(p().nftSaleBox),children:[!1!==a?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("h3",{children:["#",n]}),(0,c.jsx)(S,{url:a})]}):(0,c.jsx)(c.Fragment,{children:(0,c.jsxs)("h3",{children:["#",n]})}),!b&&(0,c.jsx)(c.Fragment,{children:g?(0,c.jsxs)(c.Fragment,{children:[T&&(0,c.jsx)("a",{className:"".concat(p().mainButton," ").concat(p().spacerBottom," primaryButton"),href:(0,j.R)("stake"),children:"Go to staking"}),y&&(0,c.jsx)("button",{disabled:l||d||x,className:"".concat(p().mainButton," ").concat(p().spacerBottom," primaryButton"),onClick:v,children:"Sell"})]}):(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("div",{className:p().nftTokenPrice,children:[s," ",r]}),k&&(0,c.jsx)(c.Fragment,{children:N?(0,c.jsx)("button",{disabled:l||d||x,className:"".concat(p().mainButton," ").concat(p().spacerBottom," primaryButton"),onClick:h,children:x&&f?"Removing...":"Remove from sale"}):(0,c.jsx)(c.Fragment,{children:i?(0,c.jsx)("button",{disabled:l||d||x,className:"".concat(p().mainButton," ").concat(p().spacerBottom," primaryButton"),onClick:m,children:l&&f?"Approving...":"Approve & Buy"}):(0,c.jsx)("button",{disabled:l||d||x,className:"".concat(p().mainButton," ").concat(p().spacerBottom," primaryButton"),onClick:u,children:d&&f?"Buying...":"Buy"})})})]})})]},n.toString())},C=t(64262),F=t(5329),I=t(44431),M=t.n(I),E=t(14284),_=t(76870),B=t(61936),R=t(27533);function O(e){var n=e.activeWeb3,t=e.openConfirmWindow,a=e.userAddress,s=e.addNotify,o=e.nftInfo,r=e.onClose,i=e.onSelled,l=e.allowedERC20Info,f=e.chainId,m=e.nftContract,g=e.marketplaceContract,y=e.tradeFee,x=(0,C.T_)(f).nativeCurrency,h=(0,u.useState)(C.r_),v=h[0],b=h[1],j=(0,u.useState)(0),k=j[0],T=j[1],N=(0,u.useState)(0),w=N[0],S=N[1],I=(0,u.useState)(!1),E=I[0],_=I[1],O=v==C.r_?x.symbol:l[v].symbol,U=(0,u.useState)(!1),Z=U[0],P=U[1],W=(0,u.useState)(!1),V=W[0],L=W[1],z=(0,u.useState)(!0),H=z[0],D=z[1],G=(0,u.useState)(!1),X=G[0],Y=G[1];(0,u.useEffect)((function(){D(!0),(0,R.r)({activeWeb3:n,nftAddress:m,ownerAddress:a,operatorAddress:g}).then((function(e){console.log(">>> approved",e),L(e),D(!1)})).catch((function(e){console.log(">>> Fail check is approved",e),D(!1)}))}),[]);var J=function(){t(k?{title:"Selling NFT",message:"Do you really want to sell NFT #".concat(o.tokenId.toString()," for ").concat(k," ").concat(O,"?"),onConfirm:function(){P(!0),s("Placing NFT to Marketplace. Confirm transaction"),(0,B.Z)({activeWeb3:n,contractAddress:g,method:"sellNFT",args:[o.tokenId.toString(),(0,F.r)(k,v==C.r_?x.decimals:l[v].decimals),v],onTrx:function(e){console.log(">> onTrx",e),s("Placing NFT at Marketplace TX ".concat(e),"success")},onSuccess:function(e){},onError:function(e){console.log(">> onError",e),s("Fail place NFT at Marketplace. ".concat(e.message?e.message:""),"error"),P(!1)},onFinally:function(e){s("NFT successfull placed at Marketplace","success"),P(!1),i()}})}}:{title:"Selling NFT",message:"Enter the correct price",isOk:!0})};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(d(),{id:"559e436679f25d92",children:".sellNftModal.jsx-559e436679f25d92{}.sellNftModal.jsx-559e436679f25d92>DIV.jsx-559e436679f25d92{min-width:700px}.sellNftModal.jsx-559e436679f25d92 .nftHolder.jsx-559e436679f25d92{width:auto}.sellNftModal.jsx-559e436679f25d92 .sellForm.jsx-559e436679f25d92{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center}.sellNftModal.jsx-559e436679f25d92 .sellForm.jsx-559e436679f25d92>DIV.jsx-559e436679f25d92{width:50%}.sellNftModal.jsx-559e436679f25d92 .inputsHolder.jsx-559e436679f25d92{text-align:left}.sellNftModal.jsx-559e436679f25d92 .inputsHolder.jsx-559e436679f25d92 LABEL.jsx-559e436679f25d92{display:block;font-weight:bold;font-size:14pt}.sellNftModal.jsx-559e436679f25d92 .inputsHolder.jsx-559e436679f25d92 SELECT.jsx-559e436679f25d92,.sellNftModal.jsx-559e436679f25d92 .inputsHolder.jsx-559e436679f25d92 INPUT.jsx-559e436679f25d92{display:block;width:100%;font-size:14pt;margin-bottom:10px;line-height:32px;height:32px}.sellNftModal.jsx-559e436679f25d92 .inputsHolder.jsx-559e436679f25d92 INPUT.jsx-559e436679f25d92{margin-bottom:0px}.sellNftModal.jsx-559e436679f25d92 .inputsHolder.jsx-559e436679f25d92 .info.jsx-559e436679f25d92 LABEL.jsx-559e436679f25d92{font-size:10pt}.sellNftModal.jsx-559e436679f25d92 .info.jsx-559e436679f25d92 STRONG.jsx-559e436679f25d92{display:block;font-size:10pt}.sellNftModal.jsx-559e436679f25d92 .error.jsx-559e436679f25d92{display:block;font-size:10pt;color:#d90d0d}"}),(0,c.jsx)("div",{className:"jsx-559e436679f25d92 "+"".concat(p().confirmWindow," sellNftModal"),children:(0,c.jsxs)("div",{className:"jsx-559e436679f25d92",children:[(0,c.jsx)("h3",{className:"jsx-559e436679f25d92",children:"Selling NFT"}),(0,c.jsx)("span",{className:"jsx-559e436679f25d92",children:"Set up sales currencies and specify the desired price"}),(0,c.jsxs)("div",{className:"jsx-559e436679f25d92 sellForm",children:[(0,c.jsx)("div",{className:"jsx-559e436679f25d92 "+"".concat(p().nftBoxGrid," nftHolder"),children:A({tokenId:o.tokenId.toString(),tokenUri:o.tokenURI,isPreview:!0})}),(0,c.jsxs)("div",{className:"jsx-559e436679f25d92 inputsHolder",children:[(0,c.jsxs)("div",{className:"jsx-559e436679f25d92",children:[(0,c.jsx)("label",{className:"jsx-559e436679f25d92",children:"Currency:"}),(0,c.jsxs)("select",{value:v,onChange:function(e){b(e.target.value)},className:"jsx-559e436679f25d92",children:[(0,c.jsxs)("option",{value:C.r_,className:"jsx-559e436679f25d92",children:["Native (",x.symbol,")"]}),Object.keys(l).length>0&&(0,c.jsx)(c.Fragment,{children:Object.keys(l).map((function(e){return(0,c.jsx)("option",{value:e,className:"jsx-559e436679f25d92",children:l[e].symbol},e)}))})]})]}),(0,c.jsxs)("div",{className:"jsx-559e436679f25d92",children:[(0,c.jsx)("label",{className:"jsx-559e436679f25d92",children:"Price:"}),E&&(0,c.jsx)("strong",{className:"jsx-559e436679f25d92 error",children:"Price must be a number greater than zero"}),(0,c.jsx)("input",{value:k,onChange:function(e){!function(n){_(!1);try{if(parseFloat(n)<=0)_(!0);else{var t=(0,F.r)(n,v==C.r_?x.decimals:l[v].decimals).toString(),a=new(M())(t).dividedBy(100).multipliedBy(y),s=new(M())(t).minus(a);S((0,F.m)(s.toFixed(),v==C.r_?x.decimals:l[v].decimals))}}catch(e){S(!1),_(!0)}T(n)}(e.target.value)},type:"number",min:"0",step:"0.001",className:"jsx-559e436679f25d92"})]}),Number(y)>0&&(0,c.jsxs)("div",{className:"jsx-559e436679f25d92 info",children:[(0,c.jsxs)("label",{className:"jsx-559e436679f25d92",children:["Marketplace fee: ",y,"%"]}),w>0&&(0,c.jsx)("strong",{className:"jsx-559e436679f25d92",children:"You are got ".concat(w," ").concat(O)})]})]})]}),(0,c.jsxs)("div",{className:"jsx-559e436679f25d92",children:[V?(0,c.jsx)("button",{disabled:Z,onClick:J,className:"jsx-559e436679f25d92 "+"".concat(p().mainButton," primaryButton"),children:"Sell"}):(0,c.jsx)("button",{disabled:Z||X||H,onClick:function(){k?(s("Approving. Confirm tx"),Y(!0),(0,R.a)({activeWeb3:n,nftAddress:m,operatorAddress:g,onTrx:function(e){console.log(">> onTrx",e),s("Approve TX ".concat(e),"success")},onSuccess:function(e){},onError:function(e){console.log(">> onError",e),s("Fail approve. ".concat(e.message?e.message:""),"error"),Y(!1)},onFinally:function(e){s("Successfull approved","success"),Y(!1),L(!0),J()}})):t({title:"Selling NFT",message:"Enter the correct price",isOk:!0})},className:"jsx-559e436679f25d92 "+"".concat(p().mainButton," primaryButton"),children:H?"Fetching...":X?"Approving...":"Approve & Sell"}),(0,c.jsx)("button",{disabled:Z||X,onClick:r,className:"jsx-559e436679f25d92 "+"".concat(p().mainButton," primaryButton"),children:"Cancel"})]})]})})]})}function U(e){var n=e.page,t=e.perPage,a=e.itemsCount,s=e.onNavigate,o=a<t?1:Math.ceil(a/t);if(1==o)return null;return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(d(),{id:"f7704a7a3bd1e511",children:"NAV.jsx-f7704a7a3bd1e511{display:block;outline:1px solid red}NAV.jsx-f7704a7a3bd1e511 A.jsx-f7704a7a3bd1e511{display:inline-block;color:#fff;padding:10px;cursor:pointer}NAV.jsx-f7704a7a3bd1e511 A.active.jsx-f7704a7a3bd1e511{outline:1px solid blue}"}),(0,c.jsx)("nav",{className:"jsx-f7704a7a3bd1e511",children:function(e,n,t,a){for(var s=[],o=e;o<n;o+=t)s.push(a(o));return s}(0,o,1,(function(e){return(0,c.jsx)("a",{onClick:function(){s(e)},className:"jsx-f7704a7a3bd1e511 "+((e==n?"active":"")||""),children:e+1})}))})]})}var Z=t(3283),P=t.n(Z),W=t(98765),V=t(23689),L=t(4248),z=function(e){var n=e.storageData,t=e.storageData.isBaseConfigReady,r=(e.isOwner,e.addNotify),l=e.getText,f=e.getDesign,y=e.openConfirmWindow,x=(e.storageMenu,(0,u.useState)(null===n||void 0===n?void 0:n.marketplaceChainId)),j=x[0],k=x[1],T=(0,u.useState)(null===n||void 0===n?void 0:n.marketplaceContract),N=T[0],S=T[1];console.log(">>> marketplaceContract",N);var I=(0,u.useState)({}),B=(I[0],I[1],(0,u.useState)(!1)),R=(B[0],B[1],(0,u.useState)([])),Z=R[0],z=R[1],H=(0,u.useState)(!0),D=H[0],G=H[1],X=(0,u.useState)(0),Y=X[0],J=X[1],q=(0,u.useState)(0),K=q[0],Q=q[1],$=(0,u.useState)({}),ee=$[0],ne=$[1],te=(0,u.useState)(!1),ae=te[0],se=te[1],oe=(0,u.useState)({}),re=oe[0],ie=oe[1],ce=(0,u.useState)(!1),le=ce[0],de=ce[1],ue=(0,u.useState)(!1),fe=ue[0],pe=ue[1],me=(0,u.useState)(!1),ge=me[0],ye=me[1],xe=(0,u.useState)(!1),he=(xe[0],xe[1],(0,u.useState)(!1)),ve=he[0],be=he[1],je=(0,u.useState)(!1),ke=je[0],Te=je[1],Ne=(0,u.useState)(!1),we=Ne[0],Se=Ne[1],Ae="ALL",Ce="USER",Fe=(0,u.useState)(Ae),Ie=Fe[0],Me=Fe[1],Ee=function(e){switch(Me(e),e){case Ae:Nn(0);break;case Ce:Ke(),an()}},_e=(0,u.useState)({}),Be=_e[0],Re=_e[1],Oe=function(e){console.log(">>> call doFetchTokenUrls",e),ee&&ae&&ee.marketNft&&(console.log(">>> call do"),(0,V.Z)({address:ee.marketNft,chainId:j,ids:e}).then((function(e){Re((0,s.Z)({},Be,e))})))},Ue=(0,u.useState)(!1),Ze=Ue[0],Pe=Ue[1],We=(0,u.useState)(!1),Ve=We[0],Le=We[1],ze=function(e){y({title:"Buying NFT",message:"Do you want buy NFT #".concat(Z[e].tokenId.toString(),"?"),onConfirm:function(){r("Buying NFT. Confirm transaction"),Le(!0),(0,b.Z)((0,o.Z)((0,s.Z)({activeWeb3:fe,contractAddress:N,method:Z[e].erc20==C.r_?"buyNFT":"buyNFTbyERC20"},Z[e].erc20==C.r_?{weiAmount:Z[e].price.toString()}:{}),{args:[Z[e].tokenId.toString()],onTrx:function(e){console.log(">> onTrx",e),r("Buy NFT TX ".concat(e),"success")},onSuccess:function(e){},onError:function(e){console.log(">> onError",e),r("Fail buy NFT. ".concat(e.message?e.message:""),"error"),Le(!1)},onFinally:function(e){r("NFT success buyed","success"),Le(!1),Ee(Ce)}}))}})},He=(0,u.useState)([]),De=He[0],Ge=He[1],Xe=(0,u.useState)(!0),Ye=(Xe[0],Xe[1],(0,u.useState)(!1)),Je=Ye[0],qe=Ye[1],Ke=function(){j&&N&&ge&&(qe(!0),(0,W.Z)({address:N,chainId:j,userAddress:ge}).then((function(e){console.log(e),Ge((0,L.Z)(e.tokens)),qe(!1),Oe((0,L.Z)(e.tokens).map((function(e){return e.tokenId})))})))},Qe=(0,u.useState)([]),$e=Qe[0],en=Qe[1],nn=(0,u.useState)(!1),tn=(nn[0],nn[1]),an=function(){j&&ee&&ee.marketNft&&ge&&(tn(!0),(0,_.Z)({chainId:j,walletAddress:ge,nftAddress:ee.marketNft}).then((function(e){en(e);var n={};e.forEach((function(e){n[e.tokenId]=e.tokenURI})),Re((0,s.Z)({},Be,n)),tn(!1)})).catch((function(e){console.log(">>> fail fetch other user nfts",e),tn(!1)})))},sn=(0,u.useState)(!1),on=sn[0],rn=sn[1],cn=(0,u.useState)({}),ln=cn[0],dn=cn[1],un=(0,u.useState)(!1),fn=(un[0],un[1]),pn=(0,u.useState)(!1),mn=pn[0],gn=pn[1];(0,u.useEffect)((function(){ee&&ae&&((0,L.Z)(ee.allowedERC20).length>0?(fn(!0),gn(!1),(0,v.Z)({erc20list:(0,L.Z)(ee.allowedERC20),chainId:j,withAllowance:!!ge&&{allowanceFrom:ge,allowanceTo:N}}).then((function(e){ie(e),fn(!1),gn(!0)})).catch((function(e){console.log("Fail fetch allowed erc20 info",e),gn(!0),fn(!1)}))):gn(!0))}),[ee]);var yn=function(e,n){var t=!1;try{t=e.message.replace("Internal JSON-RPC error.",""),t=JSON.parse(t)}catch(a){}switch(t&&t.message?t.message:e.message){case"execution reverted: You don't own this token!":console.log("You dont own this token");break;case"MetaMask Tx Signature: User denied transaction signature.":console.log("Transaction denied");break;case"execution reverted: ERC721: invalid token ID":console.log("Invalid token ID");break;default:console.log("Unkrnown error",e.message)}},xn=function(){Nn(K),Ke()},hn=function(){var e=(0,a.Z)(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!fe||"".concat(le)!="".concat(j)){e.next=4;break}window.tt=fe,fe.eth.getAccounts().then((function(e){ye(e[0])})).catch((function(e){console.log(">>> initOnWeb3Ready",e),yn(e)})),e.next=8;break;case 4:return e.next=6,(0,m.IC)();case 6:e.sent&&wn();case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),vn=(0,u.useState)(!1),bn=vn[0],jn=vn[1],kn=(0,u.useState)(0),Tn=kn[0];kn[1];(0,u.useEffect)((function(){bn&&(jn(!1),Nn(0),Ke(),an())}),[bn]),(0,u.useEffect)((function(){(0,m.Wk)(function(){var e=(0,a.Z)(i().mark((function e(n){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:ye(n),jn(!0);case 2:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}())}),[]);var Nn=function(e){j&&N&&(G(!0),(0,W.Z)({address:N,chainId:j,offset:e,limit:4,onlyTokens:!0}).then((function(e){z((0,L.Z)(e.tokensAtSale)),G(!1),Oe((0,L.Z)(e.tokensAtSale).map((function(e){return e.tokenId})))})))};(0,u.useEffect)((function(){ae&&Oe(Z.map((function(e){return e.tokenId})))}),[ae]),(0,u.useEffect)((function(){if(j&&N){var e=(0,C.T_)(j);if(e)try{var n=new(P())(e.rpcUrls[0]);pe(n),(0,W.Z)({address:N,chainId:j,offset:K,limit:4}).then((function(e){ne(e),J(e.tokensAtSaleCount),z((0,L.Z)(e.tokensAtSale)),G(!1),se(!0),ge&&an()})).catch((function(e){console.log(">>> fail fetch market info",e)}))}catch(t){console.log(">>> err",t)}}}),[j,N]),(0,u.useEffect)((function(){n&&n.marketplaceChainId&&n.marketplaceContract&&(k(n.marketplaceChainId),S(n.marketplaceContract))}),[n]),(0,u.useEffect)((function(){fe&&j&&N&&hn()}),[fe,j,N]);var wn=function(){var e=(0,a.Z)(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(0,m.pE)({onBeforeConnect:function(){be(!0)},onSetActiveChain:de,onConnected:function(e,n){pe(n),be(!1)},onError:function(e){console.log(">>>> connectWithMetamask",e),yn(e),be(!1)},needChainId:j});case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Sn=(0,C.T_)(j).nativeCurrency;return(0,c.jsxs)("div",{className:p().container,children:[(0,g.Z)("marketplace"),h({getText:l,getDesign:f}),(0,c.jsx)("h1",{className:"".concat(p().h1," pageTitle"),children:l("MarketPage_Title","NFTs Marketplace")}),(0,c.jsx)("hr",{className:"".concat(p().divider," ").concat(p().spacerTop)}),(0,c.jsxs)(c.Fragment,{children:[ge?(0,c.jsxs)("h4",{children:["Connected wallet ",ge]}):(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("div",{className:"mpBeforeConnectWallet",children:l("MarketPage_BeforeConnect_Text")}),(0,c.jsx)("button",{disabled:ve,className:"".concat(p().mainButton," primaryButton"),onClick:wn,children:ve?"Connecting":"Connect Wallet"}),(0,c.jsx)("div",{className:"mpAfterConnectWallet",children:l("MarketPage_AfterConnect_Text")})]}),ae&&mn?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("nav",{className:d().dynamic([["3bca8da8549854c9",[(0,w.V)("images/nft-media-loading.svg")]]]),children:[(0,c.jsx)("strong",{className:d().dynamic([["3bca8da8549854c9",[(0,w.V)("images/nft-media-loading.svg")]]]),children:"Show:"}),(0,c.jsx)("a",{onClick:function(){Ee(Ae)},className:d().dynamic([["3bca8da8549854c9",[(0,w.V)("images/nft-media-loading.svg")]]]),children:"All"}),ge&&(0,c.jsx)("a",{onClick:function(){Ee(Ce)},className:d().dynamic([["3bca8da8549854c9",[(0,w.V)("images/nft-media-loading.svg")]]]),children:"Your"})]}),(0,c.jsxs)("h3",{className:d().dynamic([["3bca8da8549854c9",[(0,w.V)("images/nft-media-loading.svg")]]]),children:[Ie===Ae&&(0,c.jsx)(c.Fragment,{children:"All NFTs on sale"}),Ie===Ce&&(0,c.jsx)(c.Fragment,{children:"Your NFTs on sale"})]}),(0,c.jsx)(d(),{id:"3bca8da8549854c9",dynamic:[(0,w.V)("images/nft-media-loading.svg")],children:".loadingHolder.__jsx-style-dynamic-selector{position:relative}.loading.__jsx-style-dynamic-selector{display:block;position:absolute;left:0px;top:0px;bottom:0px;right:0px;min-height:64px;background:url(".concat((0,w.V)("images/nft-media-loading.svg"),");background-position:center;-webkit-background-size:contain;-moz-background-size:contain;-o-background-size:contain;background-size:contain;background-repeat:no-repeat}")}),(0,c.jsxs)("div",{className:d().dynamic([["3bca8da8549854c9",[(0,w.V)("images/nft-media-loading.svg")]]])+" "+"".concat(p().nftBoxGrid," loadingHolder"),children:[(Ie===Ae?Z:De).map((function(e,n){e.uri;var a=e.tokenId,s=e.erc20,o=e.seller,i=(0,F.m)(e.price,s==C.r_?Sn.decimals:re[s].decimals),c=!1;return s!=C.r_&&(c=new(M())(e.price.toString()).isGreaterThan(re[s].allowance)),A({refreshIndex:Tn,currentUser:ge||"",isWalletConnected:ge,tokenId:a.toString(),tokenUri:Be[a.toString()]||!1,price:i,needApprove:c,seller:o,isERC:s!=C.r_,currency:s==C.r_?Sn.symbol:re[s].symbol,openConfirmWindow:y,isApproving:we,isBuying:Ve,isActive:n===ke,isRemoveFromTrade:Ze,isBaseConfigReady:t,onRemoveFromTrade:function(){Te(n),function(e){var n=Z[e].tokenId;y({title:"Remove lot from marketplace",message:"Do you want remove NFT #".concat(n.toString()," from marketplace?"),onConfirm:function(){Pe(!0),r("Removing NFT from marketplace. Confirm transaction"),(0,b.Z)({activeWeb3:fe,contractAddress:N,method:"deSellNFT",args:[n.toString()],onTrx:function(e){console.log(">> onTrx",e),r("Remove NFT from marketplace TX ".concat(e),"success")},onSuccess:function(e){},onError:function(e){console.log(">> onError",e),r("Fail remove NFT. ".concat(e.message?e.message:""),"error"),Pe(!1)},onFinally:function(e){r("NFT successfull removed from marketplace","success"),Pe(!1),xn()}})}})}(n)},onBuy:function(){Te(n),ze(n)},onApproveAndBuy:function(){Te(n),function(e){r("Approving... Confirm transaction");var n=Z[e],t=n.erc20,a=n.price;Se(!0),(0,E.Z)({activeWeb3:fe,chainId:j,tokenAddress:t,approveFor:N,weiAmount:a.toString(),onTrx:function(e){r("Approving TX hash ".concat(e),"success")},onFinally:function(){r("Approved","success"),Se(!1),ze(e)},onError:function(e){Se(!1),r("Fail approve token. ".concat(e.message?e.message:""),"error")}})}(n)}})})),Ie===Ae&&D&&(0,c.jsx)("div",{className:d().dynamic([["3bca8da8549854c9",[(0,w.V)("images/nft-media-loading.svg")]]])+" loading"}),Ie===Ce&&Je&&(0,c.jsx)("div",{className:d().dynamic([["3bca8da8549854c9",[(0,w.V)("images/nft-media-loading.svg")]]])+" loading"})]}),Ie===Ce&&ge&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("h2",{className:d().dynamic([["3bca8da8549854c9",[(0,w.V)("images/nft-media-loading.svg")]]]),children:"Your NFTs"}),(0,c.jsx)("hr",{className:d().dynamic([["3bca8da8549854c9",[(0,w.V)("images/nft-media-loading.svg")]]])+" "+"".concat(p().divider," ").concat(p().spacerTop)}),(0,c.jsx)("div",{className:d().dynamic([["3bca8da8549854c9",[(0,w.V)("images/nft-media-loading.svg")]]])+" "+(p().nftBoxGrid||""),children:$e.length>0?(0,c.jsx)(c.Fragment,{children:$e.map((function(e,n){return A({tokenId:e.tokenId.toString(),tokenUri:e.tokenURI,openConfirmWindow:y,isUserNFT:!0,isTradeAllow:!0,onAddToTrade:function(){!function(e){dn($e[e]),rn(!0)}(n)}})}))}):(0,c.jsx)("div",{className:d().dynamic([["3bca8da8549854c9",[(0,w.V)("images/nft-media-loading.svg")]]]),children:"You are dont have any NFTs"})}),on&&(0,c.jsx)(O,{activeWeb3:fe,openConfirmWindow:y,addNotify:r,nftInfo:ln,chainId:j,nftContract:ee.marketNft,userAddress:ge,marketplaceContract:N,isBaseConfigReady:t,allowedERC20Info:re,tradeFee:ee.tradeFee,onClose:function(){rn(!1)},onSelled:function(){rn(!1),Ke(),an()}})]}),Ie===Ae&&(0,c.jsx)(U,{page:Math.ceil(K/4),perPage:4,itemsCount:Y,onNavigate:function(e){console.log(">> go to page",e),Q(4*e),Nn(4*e)}})]}):(0,c.jsx)("div",{children:"Loading"})]})]})}},83300:function(e,n){"use strict";var t=function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof t)return t;throw new Error("unable to locate global object")}();e.exports=n=t.fetch,t.fetch&&(n.default=t.fetch.bind(t)),n.Headers=t.Headers,n.Request=t.Request,n.Response=t.Response},26566:function(e){"use strict";e.exports=JSON.parse('[{"inputs":[],"stateMutability":"nonpayable","type":"constructor"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"owner","type":"address"},{"indexed":true,"internalType":"address","name":"approved","type":"address"},{"indexed":true,"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"Approval","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"owner","type":"address"},{"indexed":true,"internalType":"address","name":"operator","type":"address"},{"indexed":false,"internalType":"bool","name":"approved","type":"bool"}],"name":"ApprovalForAll","type":"event"},{"inputs":[{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"approve","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"recipient","type":"address"},{"internalType":"string","name":"tokenURI","type":"string"}],"name":"mintNFT","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"nonpayable","type":"function"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"previousOwner","type":"address"},{"indexed":true,"internalType":"address","name":"newOwner","type":"address"}],"name":"OwnershipTransferred","type":"event"},{"inputs":[],"name":"renounceOwnership","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"from","type":"address"},{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"safeTransferFrom","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"from","type":"address"},{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"tokenId","type":"uint256"},{"internalType":"bytes","name":"data","type":"bytes"}],"name":"safeTransferFrom","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"operator","type":"address"},{"internalType":"bool","name":"approved","type":"bool"}],"name":"setApprovalForAll","outputs":[],"stateMutability":"nonpayable","type":"function"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"from","type":"address"},{"indexed":true,"internalType":"address","name":"to","type":"address"},{"indexed":true,"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"Transfer","type":"event"},{"inputs":[{"internalType":"address","name":"from","type":"address"},{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"transferFrom","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"newOwner","type":"address"}],"name":"transferOwnership","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"owner","type":"address"}],"name":"balanceOf","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"getApproved","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"owner","type":"address"},{"internalType":"address","name":"operator","type":"address"}],"name":"isApprovedForAll","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"baseExtension","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"MAX_SUPPLY","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"maxSupply","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"pure","type":"function"},{"inputs":[],"name":"name","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"owner","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"ownerOf","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"bytes4","name":"interfaceId","type":"bytes4"}],"name":"supportsInterface","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"symbol","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"tokenURI","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"totalSupply","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"}]')}},function(e){e.O(0,[852,369,431,850,317,774,888,179],(function(){return n=76771,e(e.s=n);var n}));var n=e.O();_N_E=n}]);